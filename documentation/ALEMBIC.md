## Database Migrations with Alembic

- [Alembic Documentation](https://alembic.sqlalchemy.org/en/latest/)
- [SQLAlchemy Documentation](https://docs.sqlalchemy.org/en/latest/)

1. **Create a New Migration**
   - Generate a new migration script based on your SQLAlchemy models:
     **Autogenerate Migration**

```bash
  alembic revision --autogenerate -m "Description of changes"
```

- _Example:_

  ```bash
  alembic revision --autogenerate -m "Add users table"
  ```

  **Manual Migration**

  Create a new migration script without autogenerating. This is useful for complex changes or when you need full control over the migration steps:

  ```bash
  alembic revision -m "Description of changes"
  ```

  _Example:_

  ```bash
  alembic revision -m "Add column to users table"
  ```

3. **Apply Migrations (Upgrade)**
   - Apply all pending migrations to upgrade your database schema:
     ```bash
     alembic upgrade head
     ```
   - _To upgrade to a specific revision:_
     ```bash
     alembic upgrade <revision_id>
     ```
   - _Example:_
     ```bash
     alembic upgrade abc123def456
     ```
4. **Revert Migrations (Downgrade)**
   - Revert the last applied migration:
     ```bash
     alembic downgrade -1
     ```
   - _To downgrade to a specific revision:_
     ```bash
     alembic downgrade <revision_id>
     ```
   - _Example:_
     ```bash
     alembic downgrade base
     ```
5. **View Current Migration Status**
   - Check the current revision and migration history:
     ```bash
     alembic current
     ```
   - _For a full history:_
     ```bash
     alembic history --verbose
     ```
6. **Stamp the Database with a Revision**
   - If your database is up-to-date but lacks Alembic versioning, stamp it with the latest revision:
     ```bash
     alembic stamp head
     ```
   - _To stamp with a specific revision:_
     ```bash
     alembic stamp <revision_id>
     ```
   - _Example:_
     ```bash
     alembic stamp abc123def456
     ```

**Best Practices**

- **Review Autogenerated Migrations:** Always inspect autogenerated migration scripts to ensure accuracy.
- **Commit Migrations:** Include migration scripts in version control to maintain a history of database changes.
- **Backup Your Database:** Before applying migrations, especially in production, ensure you have a recent backup.
- **Use Meaningful Messages:** When creating revisions, use descriptive messages to identify the purpose of each migration.
